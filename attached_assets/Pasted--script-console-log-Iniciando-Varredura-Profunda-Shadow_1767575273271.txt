<script>
  console.log("üïµÔ∏è Iniciando Varredura Profunda (Shadow DOM)...");

  const rastreadorVturb = setInterval(() => {
    let encontrouAlgo = false;

    // --- TENTATIVA 1: Via API Oficial (O jeito educado) ---
    if (window.smartplayer && window.smartplayer.instances && window.smartplayer.instances.length > 0) {
        window.smartplayer.instances.forEach(instance => {
            // Verifica se j√° n√£o adicionamos o listener para n√£o duplicar
            if (!instance.rastreamentoAtivo) {
                instance.on("play", () => console.log("üî• PLAY (Via API)"));
                instance.on("pause", () => console.log("‚è∏Ô∏è PAUSE (Via API)"));
                instance.rastreamentoAtivo = true; // Marca que j√° ativamos
                console.log("‚úÖ API Oficial Conectada!");
                encontrouAlgo = true;
            }
        });
    }

    // --- TENTATIVA 2: Via Shadow DOM (O jeito "bruto") ---
    // Procura o componente do VTurb na p√°gina
    const vturbElement = document.querySelector("vturb-smartplayer");
    
    // Se achou o componente e ele tem a "sombra" (conte√∫do interno) aberta
    if (vturbElement && vturbElement.shadowRoot) {
        // Tenta achar o elemento <video> real l√° dentro
        const videoNativo = vturbElement.shadowRoot.querySelector("video");
        
        if (videoNativo && !videoNativo.dataset.rastreando) {
            console.log("üîì V√≠deo Nativo encontrado no Shadow DOM!");
            
            // Adiciona o ouvinte direto no motor do navegador
            videoNativo.addEventListener("play", () => {
                console.log("üéØ PLAY DETECTADO (NATIVO)");
                // window.dataLayer.push({'event': 'video_play'});
            });

            videoNativo.addEventListener("pause", () => {
                console.log("‚è∏Ô∏è PAUSE DETECTADO (NATIVO)");
            });

            videoNativo.dataset.rastreando = "true"; // Marca para n√£o repetir
            encontrouAlgo = true;
        }
    }

    // Se qualquer um dos dois m√©todos funcionou, paramos de procurar
    if (encontrouAlgo) {
        clearInterval(rastreadorVturb);
        console.log("üöÄ Rastreamento 100% Ativo. Pode testar.");
    }

  }, 1000); // Tenta a cada 1 segundo
</script>